Создание схемы данных - около 30 мин.

План решения и тестовые запросы, небольшие апдейты схемы - чуть больше 1 часа

Написание функции  10 мин + поиск ошибки около часа 
  (промахнулся с параметров в курсоре, долго не мог понять странностей в получаемых выгрузках, 
   поэтому добавил трассировку)

код-ревью + оформление - примерно 30 мин.

----
Ну и кроме этого пришлось почитать про табличные функции, курсоры,
освежить синтаксис PL/pgSQL но это не считаю... )))

